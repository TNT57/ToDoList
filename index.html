<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimalist Todo List</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .todo-item {
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        }
        .todo-item.removing {
            opacity: 0;
            transform: scale(0.95);
        }
        .todo-item.completed span {
            text-decoration: line-through;
            color: #9ca3af;
        }
        .filter-btn.active {
            background-color: #3b82f6;
            color: white;
        }
    </style>
    <!-- Chosen Palette: Slate Gray & Sky Blue -->
    <!-- Application Structure Plan: The application uses a single-card, centered layout for a clean, focused user experience. The structure is designed for intuitive task management: a prominent header for context, an input form for adding tasks, filter controls and a task counter for organization, and a clear list for viewing tasks. This single-view approach is optimal for a minimalist to-do app, as it keeps all primary functions accessible without navigation, facilitating a rapid and efficient user workflow. -->
    <!-- Visualization & Content Choices: Report Info: Core todo list features (add, view, complete, delete, filter). Goal: Provide an organized, interactive list. Presentation Method: A dynamic HTML unordered list (`<ul>`). Each task is a list item (`<li>`) containing a checkbox, text, and delete button. Interaction: Users add tasks via a form. Checkboxes toggle completion status (visualized with a strikethrough). Delete buttons remove tasks. Filter buttons dynamically re-render the list. Justification: This structure directly maps to the core functions of a to-do list, using standard, universally understood UI elements for maximum usability. Library/Method: Vanilla JavaScript for all logic and DOM manipulation. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-100 text-slate-700">

    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-lg rounded-2xl shadow-lg p-6 sm:p-8 space-y-6">
            
            <header class="text-center space-y-2">
                <h1 class="text-3xl sm:text-4xl font-bold text-slate-800">My Tasks</h1>
                <p class="text-slate-500">Stay organized, one task at a time.</p>
            </header>

            <form id="todo-form" class="space-y-3">
                <input 
                    type="text" 
                    id="todo-input"
                    placeholder="What needs to be done?"
                    class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200"
                    required
                >
                <div class="flex flex-col sm:flex-row gap-3">
                    <input 
                        type="text" 
                        id="category-input"
                        placeholder="Category (e.g., School)"
                        class="flex-grow p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200"
                    >
                    <button 
                        type="submit"
                        class="bg-blue-500 text-white font-semibold px-6 py-3 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-transform transform hover:scale-105"
                    >
                        Add Task
                    </button>
                </div>
            </form>

            <div id="controls" class="flex flex-col sm:flex-row items-center justify-between gap-4 pt-4 border-t border-slate-200">
                <div class="flex flex-wrap items-center gap-2 sm:gap-4">
                    <div id="filter-buttons" class="flex items-center gap-2">
                        <button data-filter="all" class="filter-btn active px-4 py-2 text-sm font-medium rounded-lg hover:bg-slate-200 transition">All</button>
                        <button data-filter="active" class="filter-btn px-4 py-2 text-sm font-medium rounded-lg hover:bg-slate-200 transition">Active</button>
                        <button data-filter="completed" class="filter-btn px-4 py-2 text-sm font-medium rounded-lg hover:bg-slate-200 transition">Completed</button>
                    </div>
                    <div id="category-filter-container">
                         <select id="category-filter" class="text-sm p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 bg-white">
                            <option value="all">All Categories</option>
                        </select>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                     <span id="task-count" class="text-sm text-slate-500">0 tasks left</span>
                     <button id="clear-completed-btn" class="text-sm text-red-500 hover:text-red-700 font-medium transition hidden">Clear Completed</button>
                </div>
            </div>

            <div class="overflow-y-auto max-h-96 pr-2">
                <ul id="todo-list" class="space-y-3">
                </ul>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const todoForm = document.getElementById('todo-form');
            const todoInput = document.getElementById('todo-input');
            const categoryInput = document.getElementById('category-input');
            const todoList = document.getElementById('todo-list');
            const taskCount = document.getElementById('task-count');
            const filterButtons = document.getElementById('filter-buttons');
            const clearCompletedBtn = document.getElementById('clear-completed-btn');
            const categoryFilter = document.getElementById('category-filter');

            let todos = JSON.parse(localStorage.getItem('todos')) || [];
            let currentFilter = 'all';
            let currentCategoryFilter = 'all';

            const saveTodos = () => {
                localStorage.setItem('todos', JSON.stringify(todos));
                updateCategoryFilter();
            };

            const updateCategoryFilter = () => {
                const categories = [...new Set(todos.map(todo => todo.category).filter(Boolean))];
                const currentSelection = categoryFilter.value;
                
                categoryFilter.innerHTML = '<option value="all">All Categories</option>';
                
                categories.sort().forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categoryFilter.appendChild(option);
                });

                if (categories.includes(currentSelection)) {
                     categoryFilter.value = currentSelection;
                } else {
                    categoryFilter.value = 'all';
                    currentCategoryFilter = 'all';
                }
            };

            const renderTodos = () => {
                todoList.innerHTML = '';
                
                const filteredTodos = todos.filter(todo => {
                    const statusMatch = 
                        (currentFilter === 'active' && !todo.completed) ||
                        (currentFilter === 'completed' && todo.completed) ||
                        currentFilter === 'all';
                    
                    const categoryMatch = currentCategoryFilter === 'all' || todo.category === currentCategoryFilter;

                    return statusMatch && categoryMatch;
                });

                if (filteredTodos.length === 0) {
                    const emptyStateMessage = 
                        currentCategoryFilter !== 'all' ? `No tasks in the "${currentCategoryFilter}" category.` :
                        currentFilter === 'completed' ? "No completed tasks yet." :
                        currentFilter === 'active' ? "All tasks completed! âœ¨" :
                        "Add a task to get started!";
                    
                    todoList.innerHTML = `<li class="text-center text-slate-400 p-4">${emptyStateMessage}</li>`;
                } else {
                    filteredTodos.forEach(todo => {
                        const li = document.createElement('li');
                        li.className = `todo-item flex items-center bg-slate-50 p-3 rounded-lg shadow-sm ${todo.completed ? 'completed' : ''}`;
                        li.dataset.id = todo.id;
                        
                        li.innerHTML = `
                            <input type="checkbox" ${todo.completed ? 'checked' : ''} class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer">
                            <div class="flex-grow mx-3">
                                <span class="text-slate-800">${todo.text}</span>
                                ${todo.category ? `<span class="ml-2 text-xs font-semibold px-2 py-0.5 bg-sky-100 text-sky-700 rounded-full align-middle">${todo.category}</span>` : ''}
                            </div>
                            <button class="delete-btn text-slate-400 hover:text-red-500 transition">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        `;
                        todoList.appendChild(li);
                    });
                }
                updateTaskCount();
            };
            
            const updateTaskCount = () => {
                const activeTodos = todos.filter(todo => !todo.completed).length;
                taskCount.textContent = `${activeTodos} ${activeTodos === 1 ? 'task' : 'tasks'} left`;

                const completedExists = todos.some(todo => todo.completed);
                clearCompletedBtn.classList.toggle('hidden', !completedExists);
            };

            todoForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const newTodoText = todoInput.value.trim();
                const newTodoCategory = categoryInput.value.trim();
                if (newTodoText) {
                    const newTodo = {
                        id: Date.now(),
                        text: newTodoText,
                        completed: false,
                        category: newTodoCategory || 'General',
                    };
                    todos.unshift(newTodo);
                    saveTodos();
                    renderTodos();
                    todoInput.value = '';
                    categoryInput.value = '';
                }
            });

            todoList.addEventListener('click', (e) => {
                const target = e.target;
                const li = target.closest('.todo-item');
                if (!li) return;
                
                const todoId = Number(li.dataset.id);

                if (target.type === 'checkbox') {
                    const todo = todos.find(t => t.id === todoId);
                    todo.completed = !todo.completed;
                    saveTodos();
                    if (currentFilter !== 'all') {
                         li.classList.add('removing');
                         li.addEventListener('transitionend', () => renderTodos());
                    } else {
                        renderTodos();
                    }
                }

                if (target.closest('.delete-btn')) {
                    todos = todos.filter(t => t.id !== todoId);
                    saveTodos();
                    li.classList.add('removing');
                    li.addEventListener('transitionend', () => renderTodos());
                }
            });

            filterButtons.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    const filterValue = e.target.dataset.filter;
                    if (filterValue) {
                        currentFilter = filterValue;
                        document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                        e.target.classList.add('active');
                        renderTodos();
                    }
                }
            });

            categoryFilter.addEventListener('change', (e) => {
                currentCategoryFilter = e.target.value;
                renderTodos();
            });

            clearCompletedBtn.addEventListener('click', () => {
                todos = todos.filter(todo => !todo.completed);
                saveTodos();
                renderTodos();
            });

            updateCategoryFilter();
            renderTodos();
        });
    </script>
</body>
</html>

